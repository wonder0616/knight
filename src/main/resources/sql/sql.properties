
insert_tdr_sip_invite_total=insert into TDR_SIP_INVITE_TOTAL(CALL_ID, IPC_CODE, SERVICE_TYPE, START_TIME_MS, RESP_STATUS, RECIEVE_IP, RECIEVE_PORT, PUSH_IP, PUSH_PORT) \
select CALL_ID, IPC_CODE, SERVICE_TYPE, START_TIME_MS,RESP_STATUS, RECIEVE_IP, RECIEVE_PORT, PUSH_IP, PUSH_PORT from @PS.TDR_SIP_INVITE 

insert_tdr_sip_bye_total=insert into TDR_SIP_BYE_TOTAL(CALL_ID, IPC_CODE, START_TIME_MS, RESP_DELAY, RESP_STATUS, MS_IP, MS_PORT, SERVER_IP, SERVER_PORT)\
select CALL_ID, IPC_CODE, START_TIME_MS, RESP_DELAY, RESP_STATUS, MS_IP, MS_PORT, SERVER_IP, SERVER_PORT from @PS.TDR_SIP_BYE 

query_today_ipc2ivs_connections=select CALL_ID as callId, IPC_CODE as ipcCode, START_TIME_MS as startTime, \
RECIEVE_IP as recieveIp, RECIEVE_PORT as recievePort, PUSH_IP as pushIp, PUSH_PORT as pushPort \
from @PS.TDR_SIP_INVITE where startTime >= ? and startTime <= ? \
and ipcCode=@3

query_total_ipc2ivs_connections=select CALL_ID as callId, IPC_CODE as ipcCode,START_TIME_MS as startTime, \
RECIEVE_IP as recieveIp, RECIEVE_PORT as recievePort, PUSH_IP as pushIp, PUSH_PORT as pushPort \
from TDR_SIP_INVITE_TOTAL where startTime >= ? and startTime <= ?\
and ipcCode=@3

insert_tdr_client_play_actions_total=insert into PS.TDR_CLIENT_PLAY_ACTIONS_TOTAL select * from @PS.TDR_CLIENT_PLAY_ACTIONS

query_total_client2Ivs_allplay_connections=select SESSIONID as sessionId, SERVICE_TYPE as service_type, START_TIME as playStart, IPC_CODE as ipcCode, MAC as mac, MODEL as model from PS.TDR_CLIENT_PLAY_ACTIONS_TOTAL \
where CUR_STATUS='0' and START_TIME >= ? and START_TIME <= ? and SERVICE_TYPE = ? and ipcCode=@3

query_today_client2Ivs_allplay_connections=select SESSIONID as sessionId, SERVICE_TYPE as service_type, START_TIME as playStart,  IPC_CODE as ipcCode, MAC as mac, MODEL as model from @PS.TDR_CLIENT_PLAY_ACTIONS \
where CUR_STATUS='0' and START_TIME >= ? and START_TIME <= ? and SERVICE_TYPE = ? and ipcCode=@3

query_total_client2Ivs_finishplay_connections=select SESSIONID as sessionId, START_TIME as playEnd from TDR_CLIENT_PLAY_ACTIONS_TOTAL where CUR_STATUS='3' and sessionId in(?) 

query_today_client2Ivs_finishplay_connections=select SESSIONID as sessionId, START_TIME as playEnd from @PS.TDR_CLIENT_PLAY_ACTIONS where CUR_STATUS='3' and sessionId in(?) 

add_ipc_detail=insert into PMS.IPC_DETAIL_INFO(IPC_CODE,IPC_DEVICEID,IPC_NAME,IPC_LOCATION,IPC_LONGITUDE,IPC_LATITUDE,IPC_TYPE) values(?,?,?,?,?,?,?)
update_ipc_detail_byCode=update PMS.IPC_DETAIL_INFO set IPC_CODE=?,IPC_DEVICEID=?,IPC_NAME=?,IPC_LOCATION=?,IPC_LONGITUDE=?,IPC_LATITUDE=?,IPC_TYPE=? where IPC_CODE=?
delete_ipc_detail_byCode=delete from PMS.IPC_DETAIL_INFO where IPC_CODE in(?)
query_ipc_detail_byCode=select IPC_CODE as ipcCode, IPC_DEVICEID as ipcId,IPC_NAME as ipcName,IPC_LOCATION as ipcLocation,IPC_LONGITUDE as ipcLongitude,IPC_LATITUDE as ipcLatitude,IPC_TYPE as ipcType from PMS.IPC_DETAIL_INFO where IPC_CODE in(?)
truncate_sdr_rtp_temp=truncate table PS.SDR_RTSP_MEDIA_TEMP_@partitionByMonth

query_indicator_by_time_client_side=insert into PS.SDR_RTSP_MEDIA_TEMP_@partitionByMonth(ALL_AREA,SERVICE_TYPE,NET_TYPE,START_TIME,PROVINCE_CODE,CITY_CODE,COUNTY_CODE,TCP_UL_MAX_THROUGHPUT,TCP_DL_MAX_THROUGHPUT,TCP_UL_AVG_THROUGHPUT, \
TCP_AVG_UL_RTT,TCP_UL_PACKET_LOSS_RATE,TCP_AVG_UL_RTT_JITTER,TCP_UL_RETRANS_RATE_WITHPL,TCP_DL_AVG_THROUGHPUT,TCP_AVG_DL_RTT,TCP_DL_PACKET_LOSS_RATE,TCP_AVG_DL_RTT_JITTER, \
TCP_DL_RETRANS_RATE_WITHPL,TOTAL_EVENT_NUM,APPLICATION_INT_EVENT_NUM,LINK_INT_EVENT_NUM,LOSTPKT_ABN_EVENT_NUM,RTT_ABN_EVENT_NUM,INTERVAL_ABN_EVENT_NUM,THROUHPUT_ABN_EVENT_NUM) \
select 1, b.SERVICE_TYPE, 2, d.START_TIME_TIME, substr(b.IPC_CODE,1,2), substr(b.IPC_CODE,3,2), substr(b.IPC_CODE,5,2), d.TCP_UL_MAX_THROUGHPUT,d.TCP_DL_MAX_THROUGHPUT,d.TCP_UL_AVG_THROUGHPUT,d.TCP_AVG_UL_RTT, \
d.TCP_UL_PACKET_LOSS_RATE,d.TCP_AVG_UL_RTT_JITTER,d.TCP_UL_RETRANS_RATE_WITHPL,d.TCP_DL_AVG_THROUGHPUT,d.TCP_AVG_DL_RTT,d.TCP_DL_PACKET_LOSS_RATE,d.TCP_AVG_DL_RTT_JITTER,d.TCP_DL_RETRANS_RATE_WITHPL, \
d.TOTAL_EVENT_NUM,d.APPLICATION_INT_EVENT_NUM,d.LINK_INT_EVENT_NUM,d.LOSTPKT_ABN_EVENT_NUM,d.RTT_ABN_EVENT_NUM,d.INTERVAL_ABN_EVENT_NUM,d.THROUHPUT_ABN_EVENT_NUM \
from PS.DETAIL_RTP_MEDIA_@partitionByDay d,PS.TDR_RTSP_METHODES_@partitionByDay b \
where d.MS_IP=b.PUSH_IP and d.MS_PORT=b.PUSH_PORT and d.SERVER_IP=b.RECIEVE_IP and d.SERVER_PORT=b.RECIEVE_PORT \
and d.START_TIME_TIME >= ? and d.START_TIME_TIME<? and b.METHOD = 'Play'

query_indicator_by_time_ipc_side=insert into PS.SDR_RTSP_MEDIA_TEMP_@partitionByMonth(ALL_AREA,SERVICE_TYPE,NET_TYPE,START_TIME,PROVINCE_CODE,CITY_CODE,COUNTY_CODE,TCP_UL_MAX_THROUGHPUT,TCP_DL_MAX_THROUGHPUT,TCP_UL_AVG_THROUGHPUT, \
TCP_AVG_UL_RTT,TCP_UL_PACKET_LOSS_RATE,TCP_AVG_UL_RTT_JITTER,TCP_UL_RETRANS_RATE_WITHPL,TCP_DL_AVG_THROUGHPUT,TCP_AVG_DL_RTT,TCP_DL_PACKET_LOSS_RATE,TCP_AVG_DL_RTT_JITTER, \
TCP_DL_RETRANS_RATE_WITHPL,TOTAL_EVENT_NUM,APPLICATION_INT_EVENT_NUM,LINK_INT_EVENT_NUM,LOSTPKT_ABN_EVENT_NUM,RTT_ABN_EVENT_NUM,INTERVAL_ABN_EVENT_NUM,THROUHPUT_ABN_EVENT_NUM) \
select 1, b.SERVICE_TYPE, 1, d.START_TIME_TIME, substr(b.IPC_CODE,1,2), substr(b.IPC_CODE,3,2), substr(b.IPC_CODE,5,2), d.TCP_UL_MAX_THROUGHPUT,d.TCP_DL_MAX_THROUGHPUT,d.TCP_UL_AVG_THROUGHPUT,d.TCP_AVG_UL_RTT, \
d.TCP_UL_PACKET_LOSS_RATE,d.TCP_AVG_UL_RTT_JITTER,d.TCP_UL_RETRANS_RATE_WITHPL,d.TCP_DL_AVG_THROUGHPUT,d.TCP_AVG_DL_RTT,d.TCP_DL_PACKET_LOSS_RATE,d.TCP_AVG_DL_RTT_JITTER,d.TCP_DL_RETRANS_RATE_WITHPL, \
d.TOTAL_EVENT_NUM,d.APPLICATION_INT_EVENT_NUM,d.LINK_INT_EVENT_NUM,d.LOSTPKT_ABN_EVENT_NUM,d.RTT_ABN_EVENT_NUM,d.INTERVAL_ABN_EVENT_NUM,d.THROUHPUT_ABN_EVENT_NUM \
from PS.DETAIL_RTP_MEDIA_@partitionByDay d,PS.TDR_SIP_INVITE_@partitionByDay b \
where d.MS_IP=b.PUSH_IP and d.MS_PORT=b.PUSH_PORT and d.SERVER_IP=b.RECIEVE_IP and d.SERVER_PORT=b.RECIEVE_PORT \
and d.START_TIME_TIME >= ? and d.START_TIME_TIME<?

aggregate_By_allArea=insert into PS.SDR_RTSP_MEDIA_@partitionByMonth(SERVICE_TYPE,NET_TYPE,START_TIME, ALL_AREA, TCP_UL_MAX_THROUGHPUT, TCP_DL_MAX_THROUGHPUT, TCP_UL_AVG_THROUGHPUT, TCP_AVG_UL_RTT, TCP_UL_PACKET_LOSS_RATE,\
TCP_AVG_UL_RTT_JITTER, TCP_UL_RETRANS_RATE_WITHPL, TCP_DL_AVG_THROUGHPUT, TCP_AVG_DL_RTT, TCP_DL_PACKET_LOSS_RATE, TCP_AVG_DL_RTT_JITTER, TCP_DL_RETRANS_RATE_WITHPL, TOTAL_EVENT_NUM, APPLICATION_INT_EVENT_NUM, LINK_INT_EVENT_NUM,\
LOSTPKT_ABN_EVENT_NUM, RTT_ABN_EVENT_NUM, INTERVAL_ABN_EVENT_NUM, THROUHPUT_ABN_EVENT_NUM) \
select SERVICE_TYPE, max(NET_TYPE), max(START_TIME), ALL_AREA, avg(d.TCP_UL_MAX_THROUGHPUT),avg(d.TCP_DL_MAX_THROUGHPUT),avg(d.TCP_UL_AVG_THROUGHPUT),avg(d.TCP_AVG_UL_RTT),avg(d.TCP_UL_PACKET_LOSS_RATE), \
avg(d.TCP_AVG_UL_RTT_JITTER),avg(d.TCP_UL_RETRANS_RATE_WITHPL),avg(d.TCP_DL_AVG_THROUGHPUT),avg(d.TCP_AVG_DL_RTT),avg(d.TCP_DL_PACKET_LOSS_RATE),avg(d.TCP_AVG_DL_RTT_JITTER), avg(d.TCP_DL_RETRANS_RATE_WITHPL),\
sum(d.TOTAL_EVENT_NUM),sum(d.APPLICATION_INT_EVENT_NUM),sum(d.LINK_INT_EVENT_NUM),sum(d.LOSTPKT_ABN_EVENT_NUM),sum(d.RTT_ABN_EVENT_NUM),sum(d.INTERVAL_ABN_EVENT_NUM),sum(d.THROUHPUT_ABN_EVENT_NUM) \
from PS.SDR_RTSP_MEDIA_TEMP_@partitionByMonth d group by ALL_AREA,SERVICE_TYPE

aggregate_By_provinceCode=insert into PS.SDR_RTSP_MEDIA_@partitionByMonth(SERVICE_TYPE,NET_TYPE,START_TIME, PROVINCE_CODE, TCP_UL_MAX_THROUGHPUT, TCP_DL_MAX_THROUGHPUT, TCP_UL_AVG_THROUGHPUT, TCP_AVG_UL_RTT, TCP_UL_PACKET_LOSS_RATE,\
TCP_AVG_UL_RTT_JITTER, TCP_UL_RETRANS_RATE_WITHPL, TCP_DL_AVG_THROUGHPUT, TCP_AVG_DL_RTT, TCP_DL_PACKET_LOSS_RATE, TCP_AVG_DL_RTT_JITTER, TCP_DL_RETRANS_RATE_WITHPL, TOTAL_EVENT_NUM, APPLICATION_INT_EVENT_NUM, LINK_INT_EVENT_NUM,\
LOSTPKT_ABN_EVENT_NUM, RTT_ABN_EVENT_NUM, INTERVAL_ABN_EVENT_NUM, THROUHPUT_ABN_EVENT_NUM) \
select SERVICE_TYPE, max(NET_TYPE), max(START_TIME), PROVINCE_CODE, avg(d.TCP_UL_MAX_THROUGHPUT),avg(d.TCP_DL_MAX_THROUGHPUT),avg(d.TCP_UL_AVG_THROUGHPUT),avg(d.TCP_AVG_UL_RTT),avg(d.TCP_UL_PACKET_LOSS_RATE), \
avg(d.TCP_AVG_UL_RTT_JITTER),avg(d.TCP_UL_RETRANS_RATE_WITHPL),avg(d.TCP_DL_AVG_THROUGHPUT),avg(d.TCP_AVG_DL_RTT),avg(d.TCP_DL_PACKET_LOSS_RATE),avg(d.TCP_AVG_DL_RTT_JITTER), avg(d.TCP_DL_RETRANS_RATE_WITHPL),\
sum(d.TOTAL_EVENT_NUM),sum(d.APPLICATION_INT_EVENT_NUM),sum(d.LINK_INT_EVENT_NUM),sum(d.LOSTPKT_ABN_EVENT_NUM),sum(d.RTT_ABN_EVENT_NUM),sum(d.INTERVAL_ABN_EVENT_NUM),sum(d.THROUHPUT_ABN_EVENT_NUM) \
from PS.SDR_RTSP_MEDIA_TEMP_@partitionByMonth d group by PROVINCE_CODE,SERVICE_TYPE

aggregate_By_cityCode=insert into PS.SDR_RTSP_MEDIA_@partitionByMonth(SERVICE_TYPE,NET_TYPE,START_TIME, PROVINCE_CODE, CITY_CODE, TCP_UL_MAX_THROUGHPUT, TCP_DL_MAX_THROUGHPUT, TCP_UL_AVG_THROUGHPUT, TCP_AVG_UL_RTT, TCP_UL_PACKET_LOSS_RATE,\
  TCP_AVG_UL_RTT_JITTER, TCP_UL_RETRANS_RATE_WITHPL, TCP_DL_AVG_THROUGHPUT, TCP_AVG_DL_RTT, TCP_DL_PACKET_LOSS_RATE, TCP_AVG_DL_RTT_JITTER, TCP_DL_RETRANS_RATE_WITHPL, TOTAL_EVENT_NUM, APPLICATION_INT_EVENT_NUM, LINK_INT_EVENT_NUM,\
  LOSTPKT_ABN_EVENT_NUM, RTT_ABN_EVENT_NUM, INTERVAL_ABN_EVENT_NUM, THROUHPUT_ABN_EVENT_NUM) \
select SERVICE_TYPE, max(NET_TYPE), max(START_TIME), PROVINCE_CODE, CITY_CODE, avg(d.TCP_UL_MAX_THROUGHPUT),avg(d.TCP_DL_MAX_THROUGHPUT),avg(d.TCP_UL_AVG_THROUGHPUT),avg(d.TCP_AVG_UL_RTT),avg(d.TCP_UL_PACKET_LOSS_RATE), \
avg(d.TCP_AVG_UL_RTT_JITTER),avg(d.TCP_UL_RETRANS_RATE_WITHPL),avg(d.TCP_DL_AVG_THROUGHPUT),avg(d.TCP_AVG_DL_RTT),avg(d.TCP_DL_PACKET_LOSS_RATE),avg(d.TCP_AVG_DL_RTT_JITTER), avg(d.TCP_DL_RETRANS_RATE_WITHPL),\
sum(d.TOTAL_EVENT_NUM),sum(d.APPLICATION_INT_EVENT_NUM),sum(d.LINK_INT_EVENT_NUM),sum(d.LOSTPKT_ABN_EVENT_NUM),sum(d.RTT_ABN_EVENT_NUM),sum(d.INTERVAL_ABN_EVENT_NUM),sum(d.THROUHPUT_ABN_EVENT_NUM) \
from PS.SDR_RTSP_MEDIA_TEMP_@partitionByMonth d group by PROVINCE_CODE, CITY_CODE,SERVICE_TYPE

aggregate_By_countyCode=insert into PS.SDR_RTSP_MEDIA_@partitionByMonth(SERVICE_TYPE,NET_TYPE,START_TIME, PROVINCE_CODE, CITY_CODE, COUNTY_CODE, TCP_UL_MAX_THROUGHPUT, TCP_DL_MAX_THROUGHPUT, TCP_UL_AVG_THROUGHPUT, TCP_AVG_UL_RTT, TCP_UL_PACKET_LOSS_RATE,\
  TCP_AVG_UL_RTT_JITTER, TCP_UL_RETRANS_RATE_WITHPL, TCP_DL_AVG_THROUGHPUT, TCP_AVG_DL_RTT, TCP_DL_PACKET_LOSS_RATE, TCP_AVG_DL_RTT_JITTER, TCP_DL_RETRANS_RATE_WITHPL, TOTAL_EVENT_NUM, APPLICATION_INT_EVENT_NUM, LINK_INT_EVENT_NUM,\
  LOSTPKT_ABN_EVENT_NUM, RTT_ABN_EVENT_NUM, INTERVAL_ABN_EVENT_NUM, THROUHPUT_ABN_EVENT_NUM) \
select SERVICE_TYPE, max(NET_TYPE), max(START_TIME), PROVINCE_CODE, CITY_CODE, COUNTY_CODE, avg(d.TCP_UL_MAX_THROUGHPUT),avg(d.TCP_DL_MAX_THROUGHPUT),avg(d.TCP_UL_AVG_THROUGHPUT),avg(d.TCP_AVG_UL_RTT),avg(d.TCP_UL_PACKET_LOSS_RATE), \
avg(d.TCP_AVG_UL_RTT_JITTER),avg(d.TCP_UL_RETRANS_RATE_WITHPL),avg(d.TCP_DL_AVG_THROUGHPUT),avg(d.TCP_AVG_DL_RTT),avg(d.TCP_DL_PACKET_LOSS_RATE),avg(d.TCP_AVG_DL_RTT_JITTER), avg(d.TCP_DL_RETRANS_RATE_WITHPL),\
sum(d.TOTAL_EVENT_NUM),sum(d.APPLICATION_INT_EVENT_NUM),sum(d.LINK_INT_EVENT_NUM),sum(d.LOSTPKT_ABN_EVENT_NUM),sum(d.RTT_ABN_EVENT_NUM),sum(d.INTERVAL_ABN_EVENT_NUM),sum(d.THROUHPUT_ABN_EVENT_NUM) \
from PS.SDR_RTSP_MEDIA_TEMP_@partitionByMonth d group by PROVINCE_CODE, CITY_CODE, COUNTY_CODE,SERVICE_TYPE

query_XdrData_By_allArea=select START_TIME as startTime,PROVINCE_CODE as provinceCode,CITY_CODE as cityCode,COUNTY_CODE as countyCode,TCP_UL_MAX_THROUGHPUT as tcpUlMaxThroughput,\
  TCP_DL_MAX_THROUGHPUT as tcpDlMaxThroughput, TCP_UL_AVG_THROUGHPUT as tcpUlAvgThroughput, TCP_AVG_UL_RTT as tcpAvgUlRtt,TCP_UL_PACKET_LOSS_RATE as tcpUlPacketLossRate,\
  TCP_AVG_UL_RTT_JITTER as tcpUlRttJitter,TCP_UL_RETRANS_RATE_WITHPL as tcpUlRetransRateWithPl,TCP_DL_AVG_THROUGHPUT as tcpDlAvgThroughput,TCP_AVG_DL_RTT as tcpDlAvgRtt,\
  TCP_DL_PACKET_LOSS_RATE as tcpDlPacketLossRate,TCP_AVG_DL_RTT_JITTER as tcpDlRttJitter,TCP_DL_RETRANS_RATE_WITHPL as tcpDlRetransRateWithPl,TOTAL_EVENT_NUM as totalEventNum,\
  APPLICATION_INT_EVENT_NUM as applicationIntEventNum, LINK_INT_EVENT_NUM as linkIntEventNum,LOSTPKT_ABN_EVENT_NUM as lostPktAbnEventNum,RTT_ABN_EVENT_NUM as rttPktAbnEventNum,\
  INTERVAL_ABN_EVENT_NUM as intervalAbnEventNum,THROUHPUT_ABN_EVENT_NUM as throughputAbnEventNum,SERVICE_TYPE as serviceType,NET_TYPE as netType \
   from @PS.SDR_RTSP_MEDIA where START_TIME>=? and START_TIME<=? and NET_TYPE=? order by START_TIME

query_XdrData_By_ProvinceCode=select START_TIME as startTime,PROVINCE_CODE as provinceCode,CITY_CODE as cityCode,COUNTY_CODE as countyCode,TCP_UL_MAX_THROUGHPUT as tcpUlMaxThroughput,\
  TCP_DL_MAX_THROUGHPUT as tcpDlMaxThroughput, TCP_UL_AVG_THROUGHPUT as tcpUlAvgThroughput, TCP_AVG_UL_RTT as tcpAvgUlRtt,TCP_UL_PACKET_LOSS_RATE as tcpUlPacketLossRate,\
  TCP_AVG_UL_RTT_JITTER as tcpUlRttJitter,TCP_UL_RETRANS_RATE_WITHPL as tcpUlRetransRateWithPl,TCP_DL_AVG_THROUGHPUT as tcpDlAvgThroughput,TCP_AVG_DL_RTT as tcpDlAvgRtt,\
  TCP_DL_PACKET_LOSS_RATE as tcpDlPacketLossRate,TCP_AVG_DL_RTT_JITTER as tcpDlRttJitter,TCP_DL_RETRANS_RATE_WITHPL as tcpDlRetransRateWithPl,TOTAL_EVENT_NUM as totalEventNum,\
  APPLICATION_INT_EVENT_NUM as applicationIntEventNum, LINK_INT_EVENT_NUM as linkIntEventNum,LOSTPKT_ABN_EVENT_NUM as lostPktAbnEventNum,RTT_ABN_EVENT_NUM as rttPktAbnEventNum,\
  INTERVAL_ABN_EVENT_NUM as intervalAbnEventNum,THROUHPUT_ABN_EVENT_NUM as throughputAbnEventNum,SERVICE_TYPE as serviceType,NET_TYPE as netType \
   from PS.SDR_RTSP_MEDIA_@partitionByMonth where PROVINCE_CODE=? and START_TIME>=? and NET_TYPE=? order by START_TIME

query_XdrData_By_CityCode=select START_TIME as startTime,PROVINCE_CODE as provinceCode,CITY_CODE as cityCode,COUNTY_CODE as countyCode,TCP_UL_MAX_THROUGHPUT as tcpUlMaxThroughput,\
  TCP_DL_MAX_THROUGHPUT as tcpDlMaxThroughput, TCP_UL_AVG_THROUGHPUT as tcpUlAvgThroughput, TCP_AVG_UL_RTT as tcpAvgUlRtt,TCP_UL_PACKET_LOSS_RATE as tcpUlPacketLossRate,\
  TCP_AVG_UL_RTT_JITTER as tcpUlRttJitter,TCP_UL_RETRANS_RATE_WITHPL as tcpUlRetransRateWithPl,TCP_DL_AVG_THROUGHPUT as tcpDlAvgThroughput,TCP_AVG_DL_RTT as tcpDlAvgRtt,\
  TCP_DL_PACKET_LOSS_RATE as tcpDlPacketLossRate,TCP_AVG_DL_RTT_JITTER as tcpDlRttJitter,TCP_DL_RETRANS_RATE_WITHPL as tcpDlRetransRateWithPl,TOTAL_EVENT_NUM as totalEventNum,\
  APPLICATION_INT_EVENT_NUM as applicationIntEventNum, LINK_INT_EVENT_NUM as linkIntEventNum,LOSTPKT_ABN_EVENT_NUM as lostPktAbnEventNum,RTT_ABN_EVENT_NUM as rttPktAbnEventNum,\
  INTERVAL_ABN_EVENT_NUM as intervalAbnEventNum, THROUHPUT_ABN_EVENT_NUM as throughputAbnEventNum,SERVICE_TYPE as serviceType,NET_TYPE as netType \
   from PS.SDR_RTSP_MEDIA_@partitionByMonth where  PROVINCE_CODE=? and CITY_CODE=? and START_TIME>=? and NET_TYPE=? order by START_TIME

query_XdrData_By_CountyCode=select START_TIME as startTime,PROVINCE_CODE as provinceCode,CITY_CODE as cityCode,COUNTY_CODE as countyCode,TCP_UL_MAX_THROUGHPUT as tcpUlMaxThroughput,\
  TCP_DL_MAX_THROUGHPUT as tcpDlMaxThroughput, TCP_UL_AVG_THROUGHPUT as tcpUlAvgThroughput, TCP_AVG_UL_RTT as tcpAvgUlRtt,TCP_UL_PACKET_LOSS_RATE as tcpUlPacketLossRate,\
  TCP_AVG_UL_RTT_JITTER as tcpUlRttJitter,TCP_UL_RETRANS_RATE_WITHPL as tcpUlRetransRateWithPl,TCP_DL_AVG_THROUGHPUT as tcpDlAvgThroughput,TCP_AVG_DL_RTT as tcpDlAvgRtt,\
  TCP_DL_PACKET_LOSS_RATE as tcpDlPacketLossRate,TCP_AVG_DL_RTT_JITTER as tcpDlRttJitter,TCP_DL_RETRANS_RATE_WITHPL as tcpDlRetransRateWithPl,TOTAL_EVENT_NUM as totalEventNum,\
  APPLICATION_INT_EVENT_NUM as applicationIntEventNum, LINK_INT_EVENT_NUM as linkIntEventNum,LOSTPKT_ABN_EVENT_NUM as lostPktAbnEventNum,RTT_ABN_EVENT_NUM as rttPktAbnEventNum,\
  INTERVAL_ABN_EVENT_NUM as intervalAbnEventNum, THROUHPUT_ABN_EVENT_NUM as throughputAbnEventNum,SERVICE_TYPE as serviceType,NET_TYPE as netType \
   from PS.SDR_RTSP_MEDIA_@partitionByMonth where PROVINCE_CODE=? and CITY_CODE=? COUNTY_CODE=? and START_TIME>=? and NET_TYPE=? order by START_TIME

truncate_createdsip_connection_Total=truncate table PS.CREATED_SIP_CONNECT_TOTAL

insert_createdsip_connection_Total=insert into PS.CREATED_SIP_CONNECT_TOTAL (CALL_ID, START_TIME_MS, PATH_KEY) select CALL_ID, START_TIME_MS, PATH_KEY \
  from ( select CALL_ID, START_TIME_MS, PATH_KEY from (select START_TIME_MS,CALL_ID,PATH_KEY from @PS.TDR_SIP_INVITE \
  union all select START_TIME_MS,CALL_ID,PATH_KEY from TDR_SIP_INVITE_TOTAL))

query_interruptCount=select count(PATH_KEY) as interruptCount from CREATED_SIP_CONNECT_TOTAL where PATH_KEY in \
(select a.PATH_KEY from CREATED_SIP_CONNECT_TOTAL a, @PS.ALARM_DETAIL b \
where (a.PATH_KEY = b.PATH_KEY) AND (b.START_TIME > a.START_TIME_MS) AND (b.START_TIME > @AlarmTimeRange) AND (ALARM_LEVEL = 1))

query_deteriorationCount=select count(PATH_KEY) as deteriorationCount from CREATED_SIP_CONNECT_TOTAL where PATH_KEY in \
(select a.PATH_KEY from CREATED_SIP_CONNECT_TOTAL a, @PS.ALARM_DETAIL b \
where (a.PATH_KEY = b.PATH_KEY) AND (b.START_TIME > a.START_TIME_MS) AND (b.START_TIME > @AlarmTimeRange) AND (ALARM_LEVEL = 2))

query_createdConnectSipCount=select count(PATH_KEY) as createdCount from CREATED_SIP_CONNECT_TOTAL

get_custom_config=select KEY as key,VALUE as value,DEVICE_TYPE as deviceType,VERSION as version from PMS.CFG_EXP_CUSTOM_CONFIG where DEVICE_TYPE=? order by version desc

get_max_version_by_deviceType=select max(VERSION) as version from PMS.CFG_EXP_CUSTOM_CONFIG where DEVICE_TYPE=?

query_AlarmDetail=select BATCHNO as batchNo,ALARM_SOURCE_TYPE as alarmSourceType,PATH_KEY as pathKey,ALARM_LEVEL as alarmLevel,ALARM_INFO as alarmInfo,START_TIME as startTime \
  from @PS.ALARM_DETAIL where alarmSourceType=@0 and START_TIME>=? and START_TIME<=? and alarmLevel=@3 and PATH_KEY=@4 order by startTime

query_AlarmStatistics=select START_TIME as startTime,CLIENT_ALARM as clientAlarm,IPC_ALARM as ipcAlarm,CONNECTION_ALARM as connectionAlarm,POOR_QUALITY_ALARM as poorQualityAlarm,\
  IVS_ALARM as ivsAlarm from PS.ALARM_STATISTICS where START_TIME >=? and START_TIME <=? order by startTime

aggregate_by_clientReport=insert into AGGREGATE_TDR_SDK_CLIENT_REPORT (START_TIME, CPU_USAGE, MEM_USAGE, GPU_USAGE, RESOLUTION_WIDTH, RESOLUTION_HEIGHT, FRAME_RATE, VIDEO_BIT_RATE, \
AUDIO_BIT_RATE, DL_TRAFFIC, DL_DATATRANS_DURATION, DL_PACKET_LOSS_RATE, LOADING_DELAY, STALLING_ABN_EVENT_NUM, STALLING_DURATION, FREEZING_ABN_EVENT_NUM, FREEZING_DURATION, SLICING_ABN_EVENT_NUM,\
SLICING_DURATION, QUALITY_ABN_EVENT_NUM, CPU_USAGE_ABN_EVENT_NUM, MEM_USAGE_ABN_EVENT_NUM, LOSTPKT_ABN_EVENT_NUM, THROUGHPUT_ABN_EVENT_NUM, RETRANS_RATE_ABN_EVENT_NUM) \
select max(START_TIME), avg(CPU_USAGE), avg(MEM_USAGE), avg(GPU_USAGE), avg(RESOLUTION_WIDTH), avg(RESOLUTION_HEIGHT), avg(FRAME_RATE), avg(VIDEO_BIT_RATE), avg(AUDIO_BIT_RATE), \
avg(DL_TRAFFIC), avg(DL_DATATRANS_DURATION), avg(DL_PACKET_LOSS_RATE), avg(LOADING_DELAY), sum(STALLING_ABN_EVENT_NUM), avg(STALLING_DURATION), sum(FREEZING_ABN_EVENT_NUM), \
avg(FREEZING_DURATION), sum(SLICING_ABN_EVENT_NUM), avg(SLICING_DURATION), sum(QUALITY_ABN_EVENT_NUM), sum(CPU_USAGE_ABN_EVENT_NUM), sum(MEM_USAGE_ABN_EVENT_NUM), sum(LOSTPKT_ABN_EVENT_NUM), \
sum(THROUGHPUT_ABN_EVENT_NUM), sum(RETRANS_RATE_ABN_EVENT_NUM) from TDR_SDK_CLIENT_REPORT_@partitionByDay where START_TIME >= ? and START_TIME<?


aggregate_by_ipcReport=insert into AGGREGATE_TDR_SDK_IPC_REPORT (STARTTIME, CPU_USAGE, MEM_USAGE, AVERAGE_TEMPERATURE, RESOLUTION_WIDTH, RESOLUTION_HEIGHT, FRAME_RATE, VIDEO_BIT_RATE, \
AUDIO_BIT_RATE, UL_TRAFFIC, UL_DATATRANS_DURATION, UL_PACKET_LOSS_RATE, CODEC_ABN_EVENT_NUM, QUALITY_ABN_EVENT_NUM, TEMPERATURE_ABN_EVENT_NUM, CPU_USAGE_ABN_EVENT_NUM, MEM_USAGE_ABN_EVENT_NUM, \
LOSTPKT_ABN_EVENT_NUM, THROUHPUT_ABN_EVENT_NUM, RETRANS_RATE_ABN_EVENT_NUM) \
select max(STARTTIME), avg(CPU_USAGE), avg(MEM_USAGE), avg(AVERAGE_TEMPERATURE), avg(RESOLUTION_WIDTH), avg(RESOLUTION_HEIGHT), avg(FRAME_RATE), avg(VIDEO_BIT_RATE), avg(AUDIO_BIT_RATE), \
avg(UL_TRAFFIC), avg(UL_DATATRANS_DURATION), avg(UL_PACKET_LOSS_RATE), sum(CODEC_ABN_EVENT_NUM), sum(QUALITY_ABN_EVENT_NUM), sum(TEMPERATURE_ABN_EVENT_NUM), sum(CPU_USAGE_ABN_EVENT_NUM), \
sum(MEM_USAGE_ABN_EVENT_NUM), sum(LOSTPKT_ABN_EVENT_NUM), sum(THROUHPUT_ABN_EVENT_NUM), sum(RETRANS_RATE_ABN_EVENT_NUM) from TDR_SDK_IPC_REPORT_@partitionByDay where STARTTIME >= ? and STARTTIME<?

query_alarm_by_time_range=select ALARM_INFO as info, START_TIME as time from @PS.ALARM_DETAIL where  \
  ALARM_SOURCE_TYPE=? and START_TIME>=? and START_TIME<=? and PATH_KEY=?

query_client_event_by_time_range=select EVENT_TYPE as info, STARTTIME as time from @PS.TDR_SDK_CLIENT_EVENT where PLAY_TOKEN=? and MAC=? \
  and STARTTIME>=? and STARTTIME<=? and EVENT_TYPE in(20,21)

query_ipc_event_by_time_range=select EVENT_TYPE as info, STARTTIME as time from @PS.TDR_SDK_IPC_EVENT where IPC_CODE=? and DOMIAN_CODE=? \
  and STARTTIME>=? and STARTTIME<=?

query_rtp_event_by_time_range=select EVENT_TYPE as info, START_TIME_TIME as time from @PS.TDR_RTP_EVENT where MS_IP=? and SERVER_IP=? \
  and SERVER_PORT=? and START_TIME_TIME>=? and START_TIME_TIME<=?

query_client_connect_from_today=select IPC_CODE as ipcCode,DOMAIN_CODE as domain,START_TIME as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort, PLAY_TOKEN as playToken,\
    MAC as mac,SERVICE_TYPE as serviceType,PLAYBACK_STARTTIME as playbackBegin,PLAYBACK_ENDTIME as playbackEnd \
    from @PS.TDR_CLIENT_PLAY_ACTIONS where PLAY_TOKEN=? and MAC=? and CUR_STATUS='0' and START_TIME=\
    (select max(START_TIME) from @PS.TDR_CLIENT_PLAY_ACTIONS where PLAY_TOKEN=? and MAC=? and CUR_STATUS='0' and START_TIME<=?)

query_client_connect_from_total=select IPC_CODE as ipcCode,DOMAIN_CODE as domain,START_TIME as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort, PLAY_TOKEN as playToken,\
    MAC as mac,SERVICE_TYPE as serviceType,PLAYBACK_STARTTIME as playbackBegin,PLAYBACK_ENDTIME as playbackEnd \
    from PS.TDR_CLIENT_PLAY_ACTIONS_TOTAL where PLAY_TOKEN=? and MAC=? and CUR_STATUS='0' and START_TIME=\
    (select max(START_TIME) from PS.TDR_CLIENT_PLAY_ACTIONS_TOTAL where PLAY_TOKEN=? and MAC=? and CUR_STATUS='0' and START_TIME<=?)

query_ipc_connect_from_today=select IPC_CODE as ipcCode,START_TIME_MS as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort \
    from @PS.TDR_SIP_INVITE where IPC_CODE=? and RESP_STATUS=0 and START_TIME_MS=\
    (select max(START_TIME_MS) from @PS.TDR_SIP_INVITE where IPC_CODE=? and RESP_STATUS=0 and START_TIME_MS<=?)

query_ipc_connect_from_total=select IPC_CODE as ipcCode,START_TIME_MS as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort \
    from PS.TDR_SIP_INVITE_TOTAL where IPC_CODE=? and RESP_STATUS=0 and START_TIME_MS=\
    (select max(START_TIME_MS) from PS.TDR_SIP_INVITE_TOTAL where IPC_CODE=? and RESP_STATUS=0 and START_TIME_MS<=?)

load_alarm_detail=select BATCHNO as batchNo,ALARM_SOURCE_TYPE as alarmSourceType,PATH_KEY as pathKey,ALARM_LEVEL as alarmLevel,\
    ALARM_INFO as alarmInfo,START_TIME as startTime,ALARM_ID as alarmId from @PS.ALARM_DETAIL where START_TIME=? and BATCHNO=?

query_alarm_config=select ALARM_ID as alarmId, ALARM_SOURCE as alarmSourceType,NEED_ANALYSIS as needAnalysis,\
  ANALYSTIDS as analystIds,ALARM_LEVEL as alarmLevel from PMS.CFG_EXP_ALARM_TYPE where ALARM_ID=?

query_client_reports=select START_TIME as time, MAC as mac,IPC_CODE as ipcCode,DOMAIN_CODE as domain,SERVICE_TYPE as serviceType,\
    CPU_USAGE as cpuUsage,MEM_USAGE as memUsage,LOADING_DELAY as loadingDelay,STALLING_ABN_EVENT_NUM as stallingEventNum \
    from @PS.TDR_SDK_CLIENT_REPORT where PLAY_TOKEN=? and MAC=? and START_TIME>=? and START_TIME<=?

query_ipc_reports=select STARTTIME as time,IPC_CODE as ipcCode,DOMIAN_CODE as domain,AVERAGE_TEMPERATURE as avgTemperature,\
    CPU_USAGE as cpuUsage,MEM_USAGE as memUsage,CODEC_ABN_EVENT_NUM as abnCodecEventNum,QUALITY_ABN_EVENT_NUM as abnQualityEventNum \
    from @PS.TDR_SDK_IPC_REPORT where IPC_CODE=? and DOMIAN_CODE=? and STARTTIME>=? and STARTTIME<=?

query_rtp_reports=select START_TIME_TIME as time, MS_IP as msIp,MS_PORT as msPort,SERVER_IP as serverIp,SERVER_PORT as serverPort,\
    LINK_INT_EVENT_NUM as linkIntEventNum,LOSTPKT_ABN_EVENT_NUM as lostPktAbnEventNum,RTT_ABN_EVENT_NUM as rttAbnEventNum \
    from @PS.DETAIL_RTP_MEDIA where MS_IP=? and SERVER_IP=? and SERVER_PORT=? and START_TIME_TIME>=? and START_TIME_TIME<=?

query_client_connect_byip_from_today=select IPC_CODE as ipcCode,DOMAIN_CODE as domain,START_TIME as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort, PLAY_TOKEN as playToken,\
    MAC as mac,SERVICE_TYPE as serviceType,PLAYBACK_STARTTIME as playbackBegin,PLAYBACK_ENDTIME as playbackEnd \
    from @PS.TDR_CLIENT_PLAY_ACTIONS where RECIEVE_IP=? and PUSH_IP=? and PUSH_PORT=? and CUR_STATUS='0' and START_TIME=\
    (select max(START_TIME) from @PS.TDR_CLIENT_PLAY_ACTIONS where RECIEVE_IP=? and PUSH_IP=? and PUSH_PORT=? and CUR_STATUS='0' and START_TIME<=?)

query_client_connect_byip_from_total=select IPC_CODE as ipcCode,DOMAIN_CODE as domain,START_TIME as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort, PLAY_TOKEN as playToken,\
    MAC as mac,SERVICE_TYPE as serviceType,PLAYBACK_STARTTIME as playbackBegin,PLAYBACK_ENDTIME as playbackEnd \
    from PS.TDR_CLIENT_PLAY_ACTIONS_TOTAL where RECIEVE_IP=? and PUSH_IP=? and PUSH_PORT=? and CUR_STATUS='0' and START_TIME=\
    (select max(START_TIME) from PS.TDR_CLIENT_PLAY_ACTIONS_TOTAL where RECIEVE_IP=? and PUSH_IP=? and PUSH_PORT=? and CUR_STATUS='0' and START_TIME<=?)

query_ipc_connect_byip_from_today=select IPC_CODE as ipcCode,START_TIME_MS as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort \
    from @PS.TDR_SIP_INVITE where PUSH_IP=? and RECIEVE_IP=? and RECIEVE_PORT=? and  RESP_STATUS=0 and START_TIME_MS=\
    (select max(START_TIME_MS) from @PS.TDR_SIP_INVITE where PUSH_IP=? and RECIEVE_IP=? and RECIEVE_PORT=? and RESP_STATUS=0 and START_TIME_MS<=?)

query_ipc_connect_byip_from_total=select IPC_CODE as ipcCode,START_TIME_MS as createTime,RECIEVE_IP as receiveIp,\
    RECIEVE_PORT as receivePort, PUSH_IP as pushIp,PUSH_PORT as pushPort \
    from PS.TDR_SIP_INVITE_TOTAL where PUSH_IP=? and RECIEVE_IP=? and RECIEVE_PORT=? and RESP_STATUS=0 and START_TIME_MS=\
    (select max(START_TIME_MS) from PS.TDR_SIP_INVITE_TOTAL where PUSH_IP=? and RECIEVE_IP=? and RECIEVE_PORT=? and RESP_STATUS=0 and START_TIME_MS<=?)

query_rtsp_network_by_ipcCode=select MS_IP as msIp, MS_PORT as msPort, SERVER_IP as serverIp, SERVER_PORT as serverPort \
from @PS.TDR_CLIENT_PLAY_ACTIONS where IPC_CODE=? and START_TIME <=? order by START_TIME limit 0,1

query_ipcKqi_by_network=select START_TIME_TIME as startTime, TCP_DL_RETRANS_RATE_WITHPL as tcpDlRetransRateWithPl, TCP_DL_PACKET_LOSS_RATE as tcpDlPacketLossRate,\
TCP_DL_AVG_THROUGHPUT as tcpDlAvgThroughPut, TCP_AVG_DL_RTT_JITTER as tcpDlRttJitter, TCP_UL_RETRANS_RATE_WITHPL as tcpUlRetransRateWithPl, \
TCP_UL_PACKET_LOSS_RATE as tcpUlPacketLossRate, TCP_UL_AVG_THROUGHPUT as tcpUlAvgThroughPut,TCP_AVG_UL_RTT_JITTER as tcpUlRttJitter, LINK_INT_EVENT_NUM as linkIntEventNum,\
LOSTPKT_ABN_EVENT_NUM as lostPktAbnEventNum, RTT_ABN_EVENT_NUM as rttAbnEventNum, THROUHPUT_ABN_EVENT_NUM as throuhPutAbnEventNum \
from @PS.DETAIL_RTP_MEDIA where MS_IP=? and MS_PORT=? and SERVER_IP=? and SERVER_PORT=? and startTime>=? and startTime<=? order by startTime

query_invite_netword_by_ipcCode=select MS_IP as msIp, MS_PORT as msPort, SERVER_IP as serverIp, SERVER_PORT as serverPort \
from @PS.TDR_SIP_INVITE where IPC_CODE=? and START_TIME_MS <=? order by START_TIME_MS limit 0,1

query_allEvent_Thredhold=select * from PS.IPC_EVENT_THREDHOLD

delete_allEvent_Thredhold=alter table PS.IPC_EVENT_THREDHOLD delete where TYPE = 1

insert_allEvent_Thredhold=insert into PS.IPC_EVENT_THREDHOLD (INDEX_GROUP, INDEX_KEY, DESC, THRESHOLD, TYPE) \
   values (?,?,?,?,?)

query_all_ipc_policy=select * from PS.IPC_POLICY where platCameraId = @platCameraId

query_ipc_policy_tagKey=select * from PS.IPC_POLICY where type = -1

insert_ipc_policy=insert into PS.IPC_POLICY (POLICYID, TYPE, TRIGGER_INDEX_KEY, PHONE, EMAIL, ALARM_INTERVAL, PLAT_CAMERAID) \
  values (?,?,?,?,?,?,?) 

delete_ipc_policy=alter table PS.IPC_POLICY delete where POLICYID = @policyId

insert_protected_ipc=insert into PS.PROTECTED_IPC (platCameraID, addTime) \
  values (?,?)

delete_protected_ipc_byId=alter table PS.PROTECTED_IPC delete where platCameraID = @platCameraId

query_protected_icp_by_params=select dt.deviceID as deviceID,dt.cameraID as cameraID,dt.domainID as domainID,\
  dt.cameraName as cameraName,dt.areaID as areaID,dt.applicationType as applicationType,dt.province as province,\
  dt.city as city,dt.district as district,dt.maintainType as maintainType,dt.projectID as projectID,\
  dt.projectName as projectName,dt.platDeviceID as platDeviceID,dt.platCameraID as platCameraID,pt.addTime as addTime,\
  ht.online as online,ht.state as state from PS.IPC_DETAIL dt,PS.PROTECTED_IPC pt,PS.IPC_HEALTH_STAT ht \
  where  dt.platCameraID = pt.platCameraID and dt.platCameraID = ht.platCameraID and dt.areaId = ? \
  and dt.applicationType = ? and dt.cameraName =@3 and ht.state = ?  and ht.time > ?  order by pt.addTime limit ?,?

query_protected_icp_by_name=select dt.cameraName as cameraName,dt.platCameraID as platCameraID from \
  PS.IPC_DETAIL dt where  dt.platCameraID not in (select pt.platCameraID as platCameraID from PS.PROTECTED_IPC pt) \
  and dt.areaId = ? and dt.cameraName =? order by dt.platCameraID